# mobile/Makefile
.PHONY: help dev build test clean setup

include ../scripts/colors.mk

help: ## Admin App Mobile Flutter
	printf "$(PURPLE)üì± Admin App Mobile$(NC)"
	@grep -E '^[a-zA-Z_-]+:.*?## .*$$' $(MAKEFILE_LIST) | awk 'BEGIN {FS = ":.*?## "}; {printf "$(GREEN)%-20s$(NC) %s\\n", $$1, $$2}'

setup: ## Setup Flutter
	$(call log_info,"Setup Admin App Mobile")
	@flutter pub get
	@flutter doctor
	$(call log_success,"Admin App Mobile configuree")

dev: ## D√©marrage d√©veloppement
	$(call log_info,"Demarrage Admin App Mobile")
	@flutter run --debug
	$(call log_success,"Admin App Mobile demarre")

dev-android: ## D√©marrage Android
	@flutter run -d android

dev-ios: ## D√©marrage iOS
	@flutter run -d ios

dev-web: ## D√©marrage Web
	@flutter run -d web-server --web-port 8096

build: ## Build production
	$(call log_info,"Build Admin App Mobile")
	@flutter build apk --release
	@flutter build ios --release
	$(call log_success,"Build termine")

build-android: ## Build Android APK
	@flutter build apk --release

build-ios: ## Build iOS
	@flutter build ios --release

build-web: ## Build Web
	@flutter build web

test: ## Tests Flutter
	$(call log_info,"Tests Admin App Mobile")
	@flutter test
	$(call log_success,"Tests termines")

test-integration: ## Tests d'int√©gration
	@flutter test integration_test/

test-widget: ## Tests widgets
	@flutter test test/widget_test.dart

lint: ## Linting Dart
	@flutter analyze

format: ## Formatage Dart
	@dart format .

doctor: ## Flutter Doctor
	@flutter doctor -v

devices: ## Appareils disponibles
	@flutter devices

clean: ## Nettoyage Flutter
	@flutter clean
	@flutter pub get

upgrade: ## Mise √† jour d√©pendances
	@flutter pub upgrade


status: ## Status applications mobiles
	@printf "$(CYAN)Mobile Apps Status:$(NC)\n"
	@for app in $(MOBILE_APPS); do \
		if [ -d "$$app" ]; then \
			printf "$(GREEN)‚úÖ$(NC) $$app: Present\n"; \
		else \
			printf "$(RED)‚ùå$(NC) $$app: A creer\n"; \
		fi; \
	done
	@if command -v flutter >/dev/null 2>&1; then \
		printf "$(GREEN)‚úÖ$(NC) Flutter installe\n"; \
	else \
		printf "$(YELLOW)‚ö†Ô∏è$(NC) Flutter non installe\n"; \
	fi